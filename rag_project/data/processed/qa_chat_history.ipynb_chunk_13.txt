as a ToolMessage to the state Finally we compile our application into a single graph object In this case we are just connecting the steps into a sequence We also allow the first query_or_respond step to shortcircuit and respond directly to the user if it does not generate a tool call This allows our application to support conversational experiences eg responding to generic greetings that may not require a retrieval step Lets test our application Note that it responds appropriately to messages that do not re