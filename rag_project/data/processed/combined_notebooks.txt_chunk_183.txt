ratestate MessagesState Generate answer  Get generated ToolMessages recent_tool_messages   for message in reversedstatemessages if messagetype  tool recent_tool_messagesappendmessage else break tool_messages  recent_tool_messages1  Format into prompt docs_content  nnjoindoccontent for doc in tool_messages system_message_content   You are an assistant for questionanswering tasks  Use the following pieces of retrieved context to answer  the question If you dont know the answer say that you  dont know Use thre