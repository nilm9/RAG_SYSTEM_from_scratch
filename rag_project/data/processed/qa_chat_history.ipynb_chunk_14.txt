s that may not require a retrieval step Lets test our application Note that it responds appropriately to messages that do not require an additional retrieval step And when executing a search we can stream the steps to observe the query generation retrieval and answer generation Check out the LangSmith trace herehttpssmithlangchaincompublic7011039901d34b4b9139cbcd4edf9d6dr  Stateful management of chat history note This section of the tutorial previously used the RunnableWithMessageHistoryhttpspythonlangchain