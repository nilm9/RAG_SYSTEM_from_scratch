 prompt  reduce_promptinvokeinput response  await llmainvokeprompt return responsecontent  Add node to collapse summaries async def collapse_summariesstate OverallState doc_lists  split_list_of_docs statecollapsed_summaries length_function token_max  results   for doc_list in doc_lists resultsappendawait acollapse_docsdoc_list _reduce return collapsed_summaries results  This represents a conditional edge in the graph that determines  if we should collapse the summaries or not def should_collapse state Overa